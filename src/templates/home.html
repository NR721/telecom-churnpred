<!DOCTYPE html>
<html>
    <head>
        <title>Customer Churn Prediction | TrustTelecom</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    </head>    
    <body>

        <h1>Customer Churn Prediction</h1>
        <p><strong>Objective:</strong> This tool helps TrustTelecom’s customer retention team identify **at-risk customers** likely to switch providers. By analyzing the customer’s profile, engagement, and billing details, we can proactively **reduce churn** by offering personalized incentives.</p>
        
        <form method="POST">
            <!-- Progress Bar -->
            <div id="progress-container">
                <label for="progressBar"><strong>Form Completion:</strong></label>
                <progress id="progressBar" value="0" max="100" style="width: 80%; height: 12px;"></progress>
            </div>

            <!-- Section 1: Customer Profile -->
            <fieldset>
                <legend>Customer Profile</legend>
    
                <label for="age">Customer Age:</label>
                <input type="number" id="age" name="age" min="0" placeholder="E.g. 35">
    
                <label for="area_id">Residential Area (ID):</label>
                <input type="text" id="area_id" name="area_id" placeholder="E.g. 607">
    
                <label for="num_dependents">Number of Dependents:</label>
                <input type="number" id="num_dependents" name="num_dependents" min="0" placeholder="E.g. 2">
    
                <label for="num_referrals">Referrals Made by Customer:</label>
                <input type="number" id="num_referrals" name="num_referrals" min="0" placeholder="E.g. 3">
            </fieldset>
    
            <!-- Section 2: Subscription & Engagement Details -->
            <fieldset>
                <legend>Subscription & Engagement</legend>
    
                <label for="tenure_months">Months as a Customer:</label>
                <input type="number" id="tenure_months" name="tenure_months" min="0" placeholder="E.g. 24 (2 years)">
    
                <label for="contract_type_encoded">Contract Type:</label>
                <select id="contract_type_encoded" name="contract_type_encoded">
                    <option value="1">Month-to-Month</option>
                    <option value="2">One-Year</option>
                    <option value="3">Two-Year</option>
                </select>
    
                <label for="not_credit_card">Payment Method:</label>
                <select id="not_credit_card" name="not_credit_card">
                    <option value="0">Credit Card</option>
                    <option value="1">Other (Bank Transfer, Cash, etc.)</option>
                </select>
    
                <label for="total_premium_services">
                    Premium Services Subscribed:
                    <span title="Includes multiple lines, premium tech support, online security, online backup, and device protection services.">❔</span>
                </label>
                <input type="number" id="total_premium_services" name="total_premium_services" min="0" placeholder="E.g. 1">
                <small>Premium services include multiple lines, premium tech support, online security, online backup, and device protection.</small>
            </fieldset>
    
            <!-- Section 3: Financial & Billing -->
            <fieldset>
                <legend>Billing & Financial Data</legend>
    
                <label for="total_monthly_fee">Total Monthly Fee ($):</label>
                <input type="number" step="0.01" id="total_monthly_fee" name="total_monthly_fee" min="0" placeholder="E.g. 83.90">
    
                <label for="total_charges_quarter">Total Charges in Last Quarter ($):</label>
                <input type="number" step="0.01" id="total_charges_quarter" name="total_charges_quarter" min="0" placeholder="E.g. 267.40">
            </fieldset>
    
            <!-- Submit -->
            <input type="submit" value="Predict Churn Risk">
        </form>
    
        {% if prediction is defined %}
            <h2>Prediction Result:</h2>
            <p><strong>Churn Risk Score:</strong> {{ prediction }} (1 = Likely to Churn, 0 = Retained)</p>
        {% endif %}

        <progress id="progressBar" value="0" max="100"></progress>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let inputs = document.querySelectorAll("input, select");
        
                function updateProgress() {
                    let filled = [...inputs].filter((input) => 
                        input.value.trim() !== "" && input.value !== "0"
                    ).length;
                    let progress = (filled / inputs.length) * 100;
                    document.getElementById("progressBar").value = progress;
                }
        
                // Listen for changes in input fields & dropdowns
                inputs.forEach(input => {
                    input.addEventListener("input", updateProgress);
                    input.addEventListener("change", updateProgress);
                });
            });
        </script>        
    
    </body>
    </html>